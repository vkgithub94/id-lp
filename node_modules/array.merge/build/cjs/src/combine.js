"use strict";

var _interopRequireDefault = require("reshow-runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.combineSub = exports["default"] = void 0;

var _getObjectValue = _interopRequireDefault(require("get-object-value"));

var keys = Object.keys;

var combine = function combine(arr, objKey) {
  var nextArr = objKey ? {} : [];
  var thisArr = (0, _getObjectValue["default"])(arr, null, {});
  var thisKeys = keys(thisArr);

  if (!thisArr[thisKeys[0]] || !thisArr[thisKeys[0]].forEach) {
    console.warn('Not array.', {
      thisArr: thisArr,
      thisKeys: thisKeys
    }, thisKeys[0]);
    return;
  }

  thisArr[thisKeys[0]].forEach(function (val, key) {
    var next = {};
    var thisObjKey = key;
    thisKeys.forEach(function (k) {
      next[k] = (0, _getObjectValue["default"])(thisArr, [k, key]);

      if (objKey && objKey === k) {
        thisObjKey = next[k];
      }
    });

    if (!objKey) {
      nextArr.push(next);
    } else {
      nextArr[thisObjKey] = next;
    }
  });
  return nextArr;
};

var combineSub = function combineSub(arr, subArr, key, subObjKey) {
  arr.forEach(function (a) {
    var thisSub = (0, _getObjectValue["default"])(subArr, [a[key]]);
    a[key] = thisSub ? combine(thisSub, subObjKey) : null;
  });
  return arr;
};

exports.combineSub = combineSub;
var _default = combine;
exports["default"] = _default;